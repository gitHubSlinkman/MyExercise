---
title: "Prototype"
author: "Craig W. Slinkman"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Protype

This document is used to develop a new analysis of the my walks and riding
activities.

## Load required packges

```{r load_reqired_packages}
require( tidyverse )                   # I live in the tidyverse.
require( here )                        # To determine project file location.
require( lubridate )                   # For date manipulation.
require(flextable)                     # For table display.
#
```

## Functions

### Find all the files in the data directory of this project.

#### Function

```{r}
find_all_files <- 
    function( directory )
     {
       files <- 
            list.files(path  = directory, 
                       pattern = ".csv",
                       full.names = TRUE )
        files
    }
```

## Test function  


```{r}
project <- here()
project

data_directory <-
    file.path( project,
               "data"  )
data_directory


data_directory


files <- 
    find_all_files( data_directory )
files

n <- length(files)
n
```
  
 ### Read garmin_data_file  
 
 This function reads a single data file and changes Garmin variable to valid R
 names.  
 

### Read Garmin csv data files.  

This function reads a  Garmin data files and converts the column names into
standard R names.

#### Function

```{r}
read_garmin_file <-
    function( file_path  )
    {
        garmin_file <-
          read_csv( file_path,
                    na = c("--") )
        
        garmin_file   
    }
```

## Test read_garmin_file

```{r}
Activities <-
    read_garmin_file( files[n])
```


### Function fix_names

This is a helper function to replace blanks by underscore.  This will be used
to standardize the column names.

```{r}
require(stringr)
        
fix_name <-
    function( variable )
        { str_replace( tolower(variable), " ","_" )}
    
```

## Test variable names

```{r}
v <- "Activity Type"
fix_name(v)
```
### Function to fix all column names 

```{r}
Activities <-
   rename_with( Activities,
                fix_name )
Activities
```

## Set favorite activities to true

```{r}
################################################################################################
# Make Cycling as my favorite activity
################################################################################################
Activities <-                         
    Activities %>% 
      mutate( favorite = 
                  ifelse( activity_type == "Cycling",
                                 TRUE,
                                 FALSE ))


################################################################################################
# Remove sttrength traing as an activity Keeping only Walking and Cycling.
################################################################################################

my_activities <-
    c( "Cycling",
       "Walking")

Activities <-
    Activities %>% 
        filter( activity_type %in% my_activities )

```
```{r}
Activities %>% 
    group_by( activity_type ) %>% 
    summarise( n = n(),
               total_distance = sum( distance ),
               mean_distance  = mean(distance ),
               std_distance   = sd( distance ))

Activities %>% 
     summarise( n = n(),
               total_distance = sum( distance ),
               mean_distance  = mean(distance ),
               std_distance   = sd( distance ))
```


Activities %>% 
    group_by( activity_type ) %>% 
    summarise( n = n())
